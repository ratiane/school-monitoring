<!DOCTYPE html>
<html lang="ka">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IT სკოლების მონიტორინგი</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone@7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { 
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); 
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    @keyframes slideIn { 
      from { opacity: 0; transform: translateY(20px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    @keyframes pulse { 
      0%, 100% { opacity: 1; } 
      50% { opacity: 0.8; } 
    }
    .animate-slide-in { animation: slideIn 0.3s ease-out; }
    .animate-pulse-slow { animation: pulse 2s ease-in-out infinite; }
    .glass-effect { 
      background: rgba(31, 41, 55, 0.8); 
      backdrop-filter: blur(10px); 
      border: 1px solid rgba(255, 255, 255, 0.1); 
    }
    .hover-lift { 
      transition: transform 0.2s, box-shadow 0.2s; 
    }
    .hover-lift:hover { 
      transform: translateY(-4px); 
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); 
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    const SCHOOLS = [
      { id: 1, name: 'სსიპ - გოგიტა კიკნაძის სახელობის ქალაქ თბილისის №182 საჯარო სკოლა', shortName: '№182' },
      { id: 2, name: 'სსიპ - ზურაბ ძამუნაშვილის სახელობის ქალაქ თბილისის №220 საჯარო სკოლა', shortName: '№220' },
      { id: 3, name: 'სსიპ - ქალაქ თბილისის №108 საჯარო სკოლა', shortName: '№108' },
      { id: 4, name: 'სსიპ - ქალაქ თბილისის №131 საჯარო სკოლა', shortName: '№131' },
      { id: 5, name: 'სსიპ - ქალაქ თბილისის №152 საჯარო სკოლა', shortName: '№152' },
      { id: 6, name: 'სსიპ - ქალაქ თბილისის №176 საჯარო სკოლა', shortName: '№176' },
      { id: 7, name: 'სსიპ - ქალაქ თბილისის №215 საჯარო სკოლა', shortName: '№215' },
      { id: 8, name: 'სსიპ - ქალაქ თბილისის №73 საჯარო სკოლა', shortName: '№73' },
      { id: 9, name: 'ссიპ - ქალაქ თბილისის №76 საჯარო სკოლა', shortName: '№76' }
    ];

    const TASK_TEMPLATES = [
      "სისტემის ინსტალაცია კომპიუტერებზე",
      "ლეპტოპების გამართვა",
      "პრინტერის დაყენება/შეკეთება",
      "ინტერნეტის პრობლემის მოგვარება",
      "პროექტორის დაყენება",
      "ანტივირუსის განახლება"
    ];

    const INITIAL_VISITS = {
      4: [{ id: 1, date: '2025-10-01', description: 'პრინტერები გავმართე მანდატურთან და ასევე სპეც. მასწავლებლების ოთახში' }]
    };

    const INITIAL_PLANNED = {
      7: [{ id: 2, date: '2025-10-07', description: 'ვიზიტი', problemToSolve: '10 კომპიუტერზე სისტემის ინსტალაცია კომპ/ლაბ-ში', status: 'planned' }],
      9: [{ id: 3, date: '2025-10-08', description: 'ვიზიტი', problemToSolve: '5 ახალი ლეპტოპზე სისტემის ინსტალაცია', status: 'planned' }],
      3: [{ id: 4, date: '2025-10-09', description: 'ვიზიტი', problemToSolve: 'ბიბლიოთეკაში კეისის ჩანაცვლება ლეპტოპით და გამართვა', status: 'planned' }]
    };

    function App() {
      const [activeTab, setActiveTab] = useState('dashboard');
      const [visits, setVisits] = useState({});
      const [tasks, setTasks] = useState({});
      const [plannedVisits, setPlannedVisits] = useState({});
      const [problems, setProblems] = useState({});
      const [schoolProfiles, setSchoolProfiles] = useState({});
      const [selectedSchool, setSelectedSchool] = useState(null);
      const [showAddModal, setShowAddModal] = useState(false);
      const [modalType, setModalType] = useState('visit');

      useEffect(() => {
        try {
          const savedVisits = localStorage.getItem('schoolVisits');
          const savedTasks = localStorage.getItem('schoolTasks');
          const savedPlannedVisits = localStorage.getItem('plannedVisits');
          const savedProblems = localStorage.getItem('problems');
          const savedProfiles = localStorage.getItem('schoolProfiles');
          
          setVisits(savedVisits ? JSON.parse(savedVisits) : INITIAL_VISITS);
          setTasks(savedTasks ? JSON.parse(savedTasks) : {});
          setPlannedVisits(savedPlannedVisits ? JSON.parse(savedPlannedVisits) : INITIAL_PLANNED);
          setProblems(savedProblems ? JSON.parse(savedProblems) : {});
          setSchoolProfiles(savedProfiles ? JSON.parse(savedProfiles) : {});
        } catch (e) {
          console.error('Error loading data:', e);
          setVisits(INITIAL_VISITS);
          setPlannedVisits(INITIAL_PLANNED);
        }
      }, []);

      useEffect(() => {
        try {
          localStorage.setItem('schoolVisits', JSON.stringify(visits));
          localStorage.setItem('schoolTasks', JSON.stringify(tasks));
          localStorage.setItem('plannedVisits', JSON.stringify(plannedVisits));
          localStorage.setItem('problems', JSON.stringify(problems));
          localStorage.setItem('schoolProfiles', JSON.stringify(schoolProfiles));
        } catch (e) {
          console.error('Error saving data:', e);
        }
      }, [visits, tasks, plannedVisits, problems, schoolProfiles]);

      const getCurrentMonth = () => {
        const now = new Date();
        return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
      };

      const getMonthlyStats = (schoolId) => {
        const month = getCurrentMonth();
        const schoolVisits = visits[schoolId] || [];
        const schoolTasks = tasks[schoolId] || [];
        
        const monthVisits = schoolVisits.filter(v => v.date.startsWith(month)).length;
        const monthTasks = schoolTasks.filter(t => t.date.startsWith(month)).length;
        
        return { visits: monthVisits, tasks: monthTasks };
      };

      const getTodayInfo = useMemo(() => {
        const today = new Date().toISOString().split('T')[0];
        const todayVisits = [];
        
        SCHOOLS.forEach(school => {
          const schoolPlanned = plannedVisits[school.id] || [];
          schoolPlanned.forEach(visit => {
            if (visit.status === 'planned' && visit.date === today) {
              todayVisits.push({ ...visit, school: school.shortName, schoolId: school.id });
            }
          });
        });
        
        return todayVisits;
      }, [plannedVisits]);

      const getWeekSchedule = useMemo(() => {
        const today = new Date();
        const week = [];
        
        for (let i = 0; i < 7; i++) {
          const date = new Date(today);
          date.setDate(today.getDate() + i);
          const dateStr = date.toISOString().split('T')[0];
          
          const dayVisits = [];
          SCHOOLS.forEach(school => {
            const schoolPlanned = plannedVisits[school.id] || [];
            schoolPlanned.forEach(visit => {
              if (visit.status === 'planned' && visit.date === dateStr) {
                dayVisits.push({ ...visit, school: school.shortName });
              }
            });
          });
          
          const dayNames = ['კვი', 'ორშ', 'სამ', 'ოთხ', 'ხუთ', 'პარ', 'შაბ'];
          
          week.push({
            date: dateStr,
            dayName: dayNames[date.getDay()],
            dayNum: date.getDate(),
            visits: dayVisits
          });
        }
        
        return week;
      }, [plannedVisits]);

      const getMonthlyProgress = useMemo(() => {
        let completed = 0, total = 0;
        SCHOOLS.forEach(school => {
          const stats = getMonthlyStats(school.id);
          completed += stats.visits + stats.tasks;
          total += 4;
        });
        return { completed, total, percentage: total > 0 ? Math.round((completed / total) * 100) : 0 };
      }, [visits, tasks]);

      const addVisit = (schoolId, date, description) => {
        setVisits(prev => ({
          ...prev,
          [schoolId]: [...(prev[schoolId] || []), { id: Date.now(), date, description }]
        }));
      };

      const addTask = (schoolId, date, description) => {
        setTasks(prev => ({
          ...prev,
          [schoolId]: [...(prev[schoolId] || []), { id: Date.now(), date, description }]
        }));
      };

      const addPlannedVisit = (schoolId, date, description, problemToSolve) => {
        setPlannedVisits(prev => ({
          ...prev,
          [schoolId]: [...(prev[schoolId] || []), { id: Date.now(), date, description, problemToSolve, status: 'planned' }]
        }));
      };

      const completePlannedVisit = (schoolId, visitId, visitData) => {
        addVisit(schoolId, visitData.date, `${visitData.description} - ${visitData.problemToSolve || ''}`);
        setPlannedVisits(prev => ({
          ...prev,
          [schoolId]: (prev[schoolId] || []).map(v => 
            v.id === visitId ? { ...v, status: 'completed' } : v
          )
        }));
      };

      const exportToCSV = () => {
        let csv = 'სკოლა,თარიღი,ტიპი,აღწერა\n';
        
        SCHOOLS.forEach(school => {
          (visits[school.id] || []).forEach(v => {
            csv += `${school.shortName},${v.date},ვიზიტი,"${v.description}"\n`;
          });
          (plannedVisits[school.id] || []).forEach(p => {
            if (p.status === 'planned') {
              csv += `${school.shortName},${p.date},დაგეგმილი,"${p.problemToSolve || ''}"\n`;
            }
          });
        });
        
        const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `სკოლების_მონიტორინგი_${new Date().toISOString().split('T')[0]}.csv`;
        link.click();
      };

      const getStatusColor = (visits, tasks) => {
        if (visits >= 2 && tasks >= 2) return 'bg-gradient-to-br from-green-900 to-green-800 border-green-500';
        if (visits >= 1 || tasks >= 1) return 'bg-gradient-to-br from-yellow-900 to-yellow-800 border-yellow-500';
        return 'bg-gradient-to-br from-red-900 to-red-800 border-red-500';
      };

      const getUpcomingVisits = () => {
        const today = new Date().toISOString().split('T')[0];
        const upcoming = [];
        
        SCHOOLS.forEach(school => {
          const schoolPlanned = plannedVisits[school.id] || [];
          schoolPlanned.forEach(visit => {
            if (visit.status === 'planned' && visit.date >= today) {
              upcoming.push({ ...visit, school: school.shortName, schoolId: school.id });
            }
          });
        });
        
        return upcoming.sort((a, b) => a.date.localeCompare(b.date));
      };

      const SchoolDetailView = () => {
        if (!selectedSchool) return null;
        
        const stats = getMonthlyStats(selectedSchool.id);
        const schoolVisits = visits[selectedSchool.id] || [];
        const schoolTasks = tasks[selectedSchool.id] || [];
        const schoolPlanned = plannedVisits[selectedSchool.id] || [];
        const profile = schoolProfiles[selectedSchool.id] || {};
        
        return React.createElement('div', { className: 'space-y-6 animate-slide-in' },
          React.createElement('div', { className: 'glass-effect rounded-xl p-6' },
            React.createElement('button', {
              onClick: () => setActiveTab('dashboard'),
              className: 'text-blue-400 hover:text-blue-300 mb-4'
            }, '← უკან დაშბორდზე'),
            React.createElement('h2', { className: 'text-2xl font-bold mb-2 text-white' }, selectedSchool.name),
            
            React.createElement('div', { className: 'mt-4 p-4 bg-gray-700 rounded-lg' },
              React.createElement('h3', { className: 'font-bold text-white mb-3' }, 'სკოლის ინფორმაცია'),
              React.createElement('div', { className: 'space-y-2' },
                React.createElement('div', null,
                  React.createElement('label', { className: 'text-sm text-gray-400' }, 'კონტაქტი:'),
                  React.createElement('input', {
                    type: 'text',
                    value: profile.contact || '',
                    onChange: (e) => {
                      setSchoolProfiles(prev => ({
                        ...prev,
                        [selectedSchool.id]: { ...(prev[selectedSchool.id] || {}), contact: e.target.value }
                      }));
                    },
                    className: 'w-full mt-1 bg-gray-800 text-white px-3 py-2 rounded border border-gray-600',
                    placeholder: 'ტელეფონი, ელ-ფოსტა...'
                  })
                ),
                React.createElement('div', null,
                  React.createElement('label', { className: 'text-sm text-gray-400' }, 'შენიშვნები:'),
                  React.createElement('textarea', {
                    value: profile.notes || '',
                    onChange: (e) => {
                      setSchoolProfiles(prev => ({
                        ...prev,
                        [selectedSchool.id]: { ...(prev[selectedSchool.id] || {}), notes: e.target.value }
                      }));
                    },
                    className: 'w-full mt-1 bg-gray-800 text-white px-3 py-2 rounded border border-gray-600',
                    placeholder: 'კომპ. ლაბის ადგილმდებარეობა...',
                    rows: 3
                  })
                )
              )
            ),
            
            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4 mt-6' },
              React.createElement('div', { className: 'bg-gradient-to-br from-blue-900 to-blue-800 p-4 rounded-lg' },
                React.createElement('h3', { className: 'font-bold text-lg mb-2 text-blue-100' }, 'თვიური ვიზიტები'),
                React.createElement('p', { className: 'text-3xl font-bold text-white' }, `${stats.visits}/2`)
              ),
              React.createElement('div', { className: 'bg-gradient-to-br from-purple-900 to-purple-800 p-4 rounded-lg' },
                React.createElement('h3', { className: 'font-bold text-lg mb-2 text-purple-100' }, 'თვიური დავალებები'),
                React.createElement('p', { className: 'text-3xl font-bold text-white' }, `${stats.tasks}/2`)
              ),
              React.createElement('div', { className: 'bg-gradient-to-br from-green-900 to-green-800 p-4 rounded-lg' },
                React.createElement('h3', { className: 'font-bold text-lg mb-2 text-green-100' }, 'კვარტალური'),
                React.createElement('p', { className: 'text-3xl font-bold text-white' }, '0/6')
              )
            ),
            
            React.createElement('div', { className: 'mt-6 flex flex-wrap gap-2' },
              React.createElement('button', {
                onClick: () => {
                  setShowAddModal(true);
                  setModalType('visit');
                },
                className: 'bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700'
              }, '+ ვიზიტი'),
              React.createElement('button', {
                onClick: () => {
                  setShowAddModal(true);
                  setModalType('task');
                },
                className: 'bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700'
              }, '+ დავალება'),
              React.createElement('button', {
                onClick: () => {
                  setShowAddModal(true);
                  setModalType('planned');
                },
                className: 'bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700'
              }, '+ დაგეგმე ვიზიტი')
            )
          ),
          
          schoolPlanned.filter(p => p.status === 'planned').length > 0 && React.createElement('div', { className: 'glass-effect rounded-xl p-6 border-l-4 border-orange-500' },
            React.createElement('h3', { className: 'text-xl font-bold mb-4 text-orange-100' }, 'დაგეგმილი ვიზიტები'),
            React.createElement('div', { className: 'space-y-3' },
              schoolPlanned.filter(p => p.status === 'planned').map(visit =>
                React.createElement('div', { key: visit.id, className: 'bg-gray-800 p-4 rounded-lg border border-gray-700' },
                  React.createElement('div', { className: 'flex justify-between items-start mb-2' },
                    React.createElement('span', { className: 'font-bold text-white' }, new Date(visit.date).toLocaleDateString('ka-GE', { weekday: 'long', day: 'numeric', month: 'long' }))
                  ),
                  visit.problemToSolve && React.createElement('p', { className: 'text-gray-200 mb-3' }, visit.problemToSolve),
                  React.createElement('div', { className: 'flex gap-2' },
                    React.createElement('button', {
                      onClick: () => {
                        if (confirm('დაასრულე ვიზიტი?')) {
                          completePlannedVisit(selectedSchool.id, visit.id, visit);
                        }
                      },
                      className: 'bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm'
                    }, '✓ შესრულებული'),
                    React.createElement('button', {
                      onClick: () => {
                        const reason = prompt('გაუქმების მიზეზი:');
                        if (reason) {
                          setPlannedVisits(prev => ({
                            ...prev,
                            [selectedSchool.id]: (prev[selectedSchool.id] || []).map(v => 
                              v.id === visit.id ? { ...v, status: 'cancelled', cancelReason: reason } : v
                            )
                          }));
                        }
                      },
                      className: 'bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm'
                    }, '✗ გაუქმება')
                  )
                )
              )
            )
          ),
          
          React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-6' },
            React.createElement('div', { className: 'glass-effect rounded-xl p-6' },
              React.createElement('h3', { className: 'text-xl font-bold mb-4 text-white' }, 'ვიზიტების ისტორია'),
              React.createElement('div', { className: 'space-y-3 max-h-96 overflow-y-auto' },
                schoolVisits.length === 0 ?
                  React.createElement('p', { className: 'text-gray-400' }, 'ვიზიტები არ არის დამატებული') :
                  schoolVisits.sort((a, b) => new Date(b.date) - new Date(a.date)).map(visit =>
                    React.createElement('div', { key: visit.id, className: 'border-l-4 border-green-500 bg-gray-700 p-3 rounded' },
                      React.createElement('div', { className: 'flex justify-between mb-2' },
                        React.createElement('span', { className: 'font-bold text-white' }, 'ვიზიტი'),
                        React.createElement('span', { className: 'text-sm text-gray-400' }, new Date(visit.date).toLocaleDateString('ka-GE'))
                      ),
                      React.createElement('p', { className: 'text-gray-200' }, visit.description)
                    )
                  )
              )
            ),
            React.createElement('div', { className: 'glass-effect rounded-xl p-6' },
              React.createElement('h3', { className: 'text-xl font-bold mb-4 text-white' }, 'დავალებების ისტორია'),
              React.createElement('div', { className: 'space-y-3 max-h-96 overflow-y-auto' },
                schoolTasks.length === 0 ?
                  React.createElement('p', { className: 'text-gray-400' }, 'დავალებები არ არის დამატებული') :
                  schoolTasks.sort((a, b) => new Date(b.date) - new Date(a.date)).map(task =>
                    React.createElement('div', { key: task.id, className: 'border-l-4 border-purple-500 bg-gray-700 p-3 rounded' },
                      React.createElement('div', { className: 'flex justify-between mb-2' },
                        React.createElement('span', { className: 'font-bold text-white' }, 'დავალება'),
                        React.createElement('span', { className: 'text-sm text-gray-400' }, new Date(task.date).toLocaleDateString('ka-GE'))
                      ),
                      React.createElement('p', { className: 'text-gray-200' }, task.description)
                    )
                  )
              )
            )
          )
        );
      };

      const DashboardView = () => {
        const upcoming = getUpcomingVisits();
        const progress = getMonthlyProgress;
        
        return React.createElement('div', { className: 'space-y-6 animate-slide-in' },
          getTodayInfo.length > 0 && React.createElement('div', { className: 'glass-effect rounded-xl p-6 border-l-4 border-orange-500 animate-pulse-slow' },
            React.createElement('h3', { className: 'text-2xl font-bold mb-4 text-orange-100' }, `დღეს გაქვს ${getTodayInfo.length} ვიზიტი!`),
            React.createElement('div', { className: 'space-y-3' },
              getTodayInfo.map(visit =>
                React.createElement('div', { key: visit.id, className: 'bg-gray-800 p-4 rounded-lg border border-orange-400' },
                  React.createElement('div', { className: 'flex justify-between items-start' },
                    React.createElement('div', null,
                      React.createElement('span', { className: 'font-bold text-white text-lg' }, visit.school),
                      visit.problemToSolve && React.createElement('p', { className: 'text-orange-300 mt-2' }, `დავალება: ${visit.problemToSolve}`)
                    ),
                    React.createElement('button', {
                      onClick: () => {
                        if (confirm('დაასრულე ვიზიტი?')) {
                          completePlannedVisit(visit.schoolId, visit.id, visit);
                        }
                      },
                      className: 'bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg'
                    }, 'დასრულება')
                  )
                )
              )
            )
          ),

          React.createElement('div', { className: 'glass-effect rounded-xl p-6' },
            React.createElement('div', { className: 'flex justify-between items-center mb-6' },
              React.createElement('h3', { className: 'text-2xl font-bold text-white' }, 'თვიური პროგრესი'),
              React.createElement('span', { className: 'text-3xl font-bold text-blue-400' }, `${progress.percentage}%`)
            ),
            React.createElement('div', { className: 'w-full bg-gray-700 rounded-full h-4 overflow-hidden' },
              React.createElement('div', {
                className: 'bg-gradient-to-r from-blue-500 to-green-500 h-4 rounded-full transition-all duration-500',
                style: { width: `${progress.percentage}%` }
              })
            ),
            React.createElement('p', { className: 'text-gray-300 mt-2 text-sm' }, `${progress.completed} / ${progress.total} დასრულებული`)
          ),

          React.createElement('div', { className: 'glass-effect rounded-xl p-6' },
            React.createElement('h3', { className: 'text-xl font-bold mb-4 text-white' }, 'კვირის გეგმა'),
            React.createElement('div', { className: 'grid grid-cols-7 gap-2' },
              getWeekSchedule.map((day, idx) =>
                React.createElement('div', {
                  key: idx,
                  className: `glass-effect rounded-lg p-3 text-center hover-lift ${day.visits.length > 0 ? 'border-2 border-blue-500' : 'border border-gray-700'}`
                },
                  React.createElement('div', { className: 'text-xs text-gray-400' }, day.dayName),
                  React.createElement('div', { className: 'text-2xl font-bold text-white my-1' }, day.dayNum),
                  React.createElement('div', { className: 'text-xs' },
                    day.visits.length > 0 ?
                      React.createElement('div', { className: 'space-y-1' },
                        day.visits.map((v, i) =>
                          React.createElement('div', { key: i, className: 'text-blue-400 font-medium truncate' }, v.school)
                        )
                      ) :
                      React.createElement('span', { className: 'text-gray-500' }, '-')
                  )
                )
              )
            )
          ),

          React.createElement('div', { className: 'glass-effect rounded-xl p-6' },
            React.createElement('h2', { className: 'text-2xl font-bold mb-4 text-white' }, `მიმოხილვა - ${new Date().toLocaleDateString('ka-GE', { month: 'long', year: 'numeric' })}`),
            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4' },
              SCHOOLS.map(school => {
                const stats = getMonthlyStats(school.id);
                const statusColor = getStatusColor(stats.visits, stats.tasks);
                
                return React.createElement('div', {
                  key: school.id,
                  className: `${statusColor} border-l-4 rounded-lg p-4 cursor-pointer hover-lift`,
                  onClick: () => {
                    setSelectedSchool(school);
                    setActiveTab('school');
                  }
                },
                  React.createElement('h3', { className: 'font-bold text-lg mb-2 text-white' }, school.shortName),
                  React.createElement('div', { className: 'space-y-2 text-sm text-gray-200' },
                    React.createElement('div', { className: 'flex items-center justify-between' },
                      React.createElement('span', null, 'ვიზიტები (თვე):'),
                      React.createElement('span', { className: 'font-bold' }, `${stats.visits}/2`)
                    ),
                    React.createElement('div', { className: 'flex items-center justify-between' },
                      React.createElement('span', null, 'დავალებები (თვე):'),
                      React.createElement('span', { className: 'font-bold' }, `${stats.tasks}/2`)
                    )
                  )
                );
              })
            )
          ),

          React.createElement('button', {
            onClick: exportToCSV,
            className: 'glass-effect px-6 py-3 rounded-lg text-white font-medium hover-lift'
          }, 'ექსპორტი CSV')
        );
      };

      const AddModal = () => {
        const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
        const [description, setDescription] = useState('');
        const [problemToSolve, setProblemToSolve] = useState('');
        const [school, setSchool] = useState(selectedSchool?.id || SCHOOLS[0].id);
        const [showTemplates, setShowTemplates] = useState(false);
        
        const handleSubmit = () => {
          if (modalType === 'visit') {
            addVisit(school, date, description);
          } else if (modalType === 'task') {
            addTask(school, date, description);
          } else if (modalType === 'planned') {
            addPlannedVisit(school, date, description || 'ვიზიტი', problemToSolve);
          }
          
          setDescription('');
          setProblemToSolve('');
          setShowAddModal(false);
        };
        
        return React.createElement('div', { className: 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50' },
          React.createElement('div', { className: 'glass-effect rounded-xl p-6 max-w-md w-full mx-4 border border-gray-700' },
            React.createElement('h3', { className: 'text-xl font-bold mb-4 text-white' },
              modalType === 'visit' ? 'დაამატე ვიზიტი' :
              modalType === 'task' ? 'დაამატე დავალება' :
              'დაგეგმე ვიზიტი'
            ),
            React.createElement('div', { className: 'space-y-4' },
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm font-medium mb-2 text-gray-200' }, 'სკოლა'),
                React.createElement('select', {
                  value: school,
                  onChange: (e) => setSchool(parseInt(e.target.value)),
                  className: 'w-full border border-gray-600 rounded-lg px-3 py-2 bg-gray-700 text-white'
                },
                  SCHOOLS.map(s =>
                    React.createElement('option', { key: s.id, value: s.id }, s.shortName)
                  )
                )
              ),
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm font-medium mb-2 text-gray-200' }, 'თარიღი'),
                React.createElement('input', {
                  type: 'date',
                  value: date,
                  onChange: (e) => setDate(e.target.value),
                  className: 'w-full border border-gray-600 rounded-lg px-3 py-2 bg-gray-700 text-white'
                })
              ),
              modalType === 'planned' ? 
                React.createElement('div', null,
                  React.createElement('div', { className: 'flex justify-between items-center mb-2' },
                    React.createElement('label', { className: 'text-sm font-medium text-gray-200' }, 'დავალება'),
                    React.createElement('button', {
                      onClick: () => setShowTemplates(!showTemplates),
                      className: 'text-xs text-blue-400 hover:underline'
                    }, 'შაბლონები')
                  ),
                  showTemplates && React.createElement('div', { className: 'mb-2 p-2 bg-gray-700 rounded space-y-1 max-h-40 overflow-y-auto' },
                    TASK_TEMPLATES.map((template, idx) =>
                      React.createElement('button', {
                        key: idx,
                        onClick: () => {
                          setProblemToSolve(template);
                          setShowTemplates(false);
                        },
                        className: 'block w-full text-left px-2 py-1 text-sm text-gray-300 hover:bg-gray-600 rounded'
                      }, template)
                    )
                  ),
                  React.createElement('textarea', {
                    value: problemToSolve,
                    onChange: (e) => setProblemToSolve(e.target.value),
                    className: 'w-full border border-gray-600 rounded-lg px-3 py-2 h-24 bg-gray-700 text-white',
                    placeholder: 'დავალების აღწერა...'
                  })
                ) :
                React.createElement('div', null,
                  React.createElement('label', { className: 'block text-sm font-medium mb-2 text-gray-200' }, 'აღწერა'),
                  React.createElement('textarea', {
                    value: description,
                    onChange: (e) => setDescription(e.target.value),
                    className: 'w-full border border-gray-600 rounded-lg px-3 py-2 h-24 bg-gray-700 text-white',
                    placeholder: 'შეიყვანე აღწერა...'
                  })
                )
            ),
            React.createElement('div', { className: 'flex gap-3 mt-6' },
              React.createElement('button', {
                onClick: handleSubmit,
                className: 'flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700'
              }, 'დამატება'),
              React.createElement('button', {
                onClick: () => {
                  setShowAddModal(false);
                  setDescription('');
                  setProblemToSolve('');
                },
                className: 'flex-1 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700'
              }, 'გაუქმება')
            )
          )
        );
      };

      return React.createElement('div', { className: 'min-h-screen' },
        React.createElement('header', { className: 'glass-effect text-white p-4 shadow-lg' },
          React.createElement('h1', { className: 'text-2xl font-bold', style: { background: 'linear-gradient(to right, #60a5fa, #a78bfa)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent' } }, 'IT სკოლების მონიტორინგი'),
          React.createElement('p', { className: 'text-sm text-gray-300' }, '9 საჯარო სკოლის მართვის სისტემა')
        ),
        React.createElement('nav', { className: 'glass-effect shadow-md border-b border-gray-700' },
          React.createElement('div', { className: 'flex gap-1 p-2' },
            React.createElement('button', {
              onClick: () => setActiveTab('dashboard'),
              className: `flex items-center gap-2 px-4 py-2 rounded-lg ${activeTab === 'dashboard' ? 'bg-blue-600 text-white' : 'text-gray-300 hover:bg-gray-700'}`
            }, 'დაშბორდი'),
            React.createElement('button', {
              onClick: () => {
                setShowAddModal(true);
                setModalType('visit');
              },
              className: 'ml-auto bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700'
            }, '+ ვიზიტი'),
            React.createElement('button', {
              onClick: () => {
                setShowAddModal(true);
                setModalType('planned');
              },
              className: 'bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700'
            }, '+ დაგეგმე')
          )
        ),
        React.createElement('main', { className: 'container mx-auto p-4' },
          activeTab === 'dashboard' ? React.createElement(DashboardView) :
          activeTab === 'school' ? React.createElement(SchoolDetailView) : null
        ),
        showAddModal && React.createElement(AddModal)
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(App));
  </script>
</body>
</html>